<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="XUpload.js"></script>
    <!--<script src="ajaxUpload.js"></script>-->
</head>
<body>
    <div id="box">上传文件</div>
    <!---->
    <!--<form action="http://127.0.0.1/index.php" method="POST" enctype="multipart/form-data">-->
        <!--　　<input type="file" name="fs" multiple>-->
        <!--　　<input id="btn" type="button" value="上传">-->
    <!--</form>-->
    <script>
        var a = XUpload({
            el: '#box',
            url: 'http://127.0.0.1:8081/upfile',
            name: 'aaa',
            autoSubmit: true,
            data: {
                a: 1,
                b: 2
            },
            fileType: ['psd'],
            eachQuantity: 1,
            // 严格模式,当开启此模式时,必须所有文件都符合规格才算效验成功,否则效验失败
            strict: true,
            responseType: 'json',
            // 文件效验失败
            checkError: function (files) {
                console.log(files);
            },
            // 文件效验成功
            checkSuccess: function (files) {
                console.log(files);
            },
            onChange: function (file) {
                console.log('change', file);
            },
            onSubmit: function (file) {
                console.log('submit', file);
            },
            onProgress: function (loaded, total) {
                console.log(loaded, total);
            },
            onSuccess: function (result) {
                console.log('success', result, this);
            },
            onError: function (result) {
                console.log('error', result, this);
            }
        });
    </script>
    <script>
//        var upload = new AjaxUpload($upload, {
//            action: uploadUrl,
//            name: "uploadfile",
//            responseType: 'json',
//            data: {
//                entity_id: 'entity_id',
//                attachment_type: 'attachment_type',
//                entity_name: 'entity_name'
//            },
//
//            // 选中文件
//            onChange: function() {
//                var _url = window.location.href;
//                if(_url.indexOf('company') !== -1)
//                {
//                    // 公司费用
//                    if(_url.indexOf('_CO') !== -1)
//                    {
//                        if(typeof EA !== 'undefined') EA.cacheStartTime('companyAttachmentUpload');
//                    }
//
//                }
//                else
//                {
//                    // 个人费用
//                    if(typeof EA !== 'undefined'){
//                        EA.cacheStartTime('attachmentUpload');
//                    }
//                }
//            },
//
//            // 点击-附件上传
//            onSubmit: function(file, ext) {
//                var _url = window.location.href;
//                /* if(_url.indexOf('company') !== -1)
//                 {
//                 // 公司费用
//                 if(_url.indexOf('_CO') !== -1)
//                 {
//                 if(typeof EA !== 'undefined') EA.clickStat('companyAttachmentUpload');
//                 }
//
//                 }
//                 else
//                 {
//                 // 个人费用
//                 // if(typeof EA !== 'undefined') EA.clickStat('attachmentUpload');
//                 }*/
//
//                $upload.addClass('uploading');
//                setTimeout(function() {
//                    if ($upload.hasClass('uploading')) {
//                        tip.error({
//                            msg: lang.zll_error_uploadFail
//                        });
//                        $upload.removeClass('uploading');
//                        $upText.html(lang.zll_hint_reUpload);
//                    }
//                }, 10000);
//            },
//            onComplete: function(file, response) {
//                if (!!response.flag) {
//                    $upload.removeClass('uploading');
//                    $upText.html(lang.zll_hint_upload);
//                    var match = file.match(/\.([\w]+)$/);
//                    var html = '<li><span class="icon-file ' + (match && match.length > 1 ? match[1] : '') + '"></span> <a class="text link" data-value="' + response.data.fileId + '">' + file + '</a> <span class="icon-delete">&times;</span> </li>';
//                    // $instruc.css('display', 'none');
//                    $downloadList.append(html);
//                    baseVM.output.attachmentInfo.push({
//                        attachmentId: response.data.fileId,
//                        attachmentDesc: file
//                    });
//                    baseVM.$inData.attachmentInfo = baseVM.output.attachmentInfo;
//                } else {
//                    tip.error({
//                        msg: lang.zll_error_uploadFail
//                    });
//                    $upload.removeClass('uploading');
//                    $upText.html(lang.zll_hint_reUpload);
//                }
//
//                if(typeof EA !== 'undefined') EA.trackResponseTimeUsingTags([
//                    'attachmentUpload',
//                    'companyAttachmentUpload'
//                ]);
//            }
//        });
    </script>
</body>
</html>